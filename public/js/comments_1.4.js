YUI({combine:true,comboBase:window.GLOBAL_COMBOBASE}).use("node","io-base","json-parse","delegate","substitute",function(c){var q='<div class="arti-s"><div class="arti-s-hd"><h2 class="arti-s-hd-title">\u70ed\u95e8\u70b9\u8bc4</h2><span class="arti-s-hd-more"><a href="javascript:void(0);" target="_self" class="btn-comment-add" id="btn-comments-add" rule="post"></a></span></div><div class="arti-s-bd"><div class="p-v20 t-c f14px"><p>\u6682\u65f6\u8fd8\u6ca1\u6709\u4eba\u70b9\u8bc4\u8fc7\uff0c\u4f60\u6765\u8bf4\u51e0\u53e5\u5427~</p><p class="m-t5"><a href="javascript:void(0);" target="_self" class="a-orange" id="btn-comments-add1" rule="post">\u6211\u8981\u70b9\u8bc4</a></p></div></div></div>',u='<div class="arti-s"><div class="arti-s-hd"><h2 class="arti-s-hd-title">\u6211\u7684\u70b9\u8bc4</h2><span class="arti-s-hd-more"><a href="#" target="_self" class="a-orange" id="btn-comments-edit" rule="post">[\u4fee\u6539]</a></span></div><div class="arti-s-bd"><div class="p-v20 p-h10"><div class="comment-item"><div class="comment-avatar"><a href="{link}" class="img-app-avatar" title="{info}"><i class="img-app-none"></i>{vip}<img src="{avatar}" alt="" /></a></div><div class="comment-main"><p><span class="comment-date fl-r c-gray">{date} \u53d1\u8868</span><a href="{link}" class="a-orange comment-uname" title="{info}">{name}</a>{vote}</p><p class="m-t5 f14px c-gray t-wrap">{content}</p>{imgs}<div class="m-t5"><span class="comment-vote-disabled"><i>({up})</i></span><a href="{replyLink}" class="comment-reply m-l10" target="_self"><i>({reply})</i></a></div></div></div></div></div></div>',y='<div class="arti-s"><div class="arti-s-hd"><h2 class="arti-s-hd-title">\u70ed\u95e8\u70b9\u8bc4</h2>{addComment}</div><div class="arti-s-bd" id="list-comments">{hotList}</div></div>',h='<div class="p-v20 p-h10 bg-dotted-b"><div class="comment-item"><div class="comment-avatar"><a href="{link}" class="img-app-avatar" title="{info}"><i class="img-app-none"></i>{vip}<img src="{avatar}" alt="" /></a></div><div class="comment-main"><p><span class="comment-date fl-r c-gray">{date} \u53d1\u8868</span><a href="{link}" class="a-orange comment-uname" title="{info}">{name}</a>{vote}</p><p class="m-t5 f14px c-gray t-wrap">{content}</p>{imgs}<div class="m-t5"><span class="comment-vote" commentID="{comId}"><i>({up})</i></span><a href="{replyLink}" class="comment-reply m-l10" target="_self"><i>({reply})</i></a></div></div></div></div>',x='<span class="vote-column m-l10"><i style="width:{star}"></i></span><span class="vote-text c-gray m-r20">{label}</span>',p='<li location={location}><div class="box-download-shot"><img src="{url}" width="140" height="140" title="\u70b9\u51fb\u67e5\u770b\u5927\u56fe"></div></li>';var j=c.one("#comments-container"),A=c.Node.create,b=["","\u7cdf\u7cd5","\u8f83\u5dee","\u4e00\u822c","\u4e0d\u9519","\u529b\u8350"],a=0,f=-1,m=45;z();j.delegate("click",function(D){var B=D.currentTarget,C=B.getAttribute("location");d(C)},".shot-list li");window.refreshList=z;function e(){var B=window.commentData;if(B&&B.hot&&B.hot.length>0){s(B)}else{v()}}function s(E){var F="",K="",G="",J=window.configJson.replyBaseUrl;if(E.mycomment){F=r(E.mycomment)}var I=E.hot,H,B;a=f!=-1?I.length:I.length<5?I.length:5;for(var D=0,C;D<a;++D){I[D].vote=w(I[D].grade);H=I[D].shots;if(H){B='<ul class="shot-list">';for(C=0;C<H.length;++C){H[C].location="hot-"+D+"-"+C;B+=c.substitute(p,H[C])}B+="</ul>"}else{B=""}I[D].imgs=B;I[D].vip=k(I[D]);I[D].replyLink=J+I[D].comId+".html";I[D].info=I[D].info?I[D].info:"";K+=c.substitute(h,I[D])}if(!F){G='<span class="arti-s-hd-more"><a href="javascript:void(0);" target="_self" class="btn-comment-add" id="btn-comments-add" rule="post"></a></span>'}K=c.substitute(y,{hotList:K,addComment:G});c.delegate("click",function(L){if(window.logined){i(L)}else{window.showLoginOverlay()}},j,".comment-vote");j.removeClass("component-loading");j.appendChild(F+K);if(f!=-1){n()}else{o()}}function n(){var P='<div class="yui3-appsview-page" style="text-align:right;"></div>',C='<a href="#{qs}" target="_self" class="{className}">{text}</a>',O='<span class="yui3-appsview-page-ellipsis">\u2026\u2026</span>',B=f,H="",M=2,K=window.commentData.count,G,J,L,I,E,N,F;if(K>m){H=[],L=Math.ceil(B/m),J=Math.ceil(K/m),I=G=0,E=J-1,N=F=false;H.push(c.substitute(C,{qs:Math.max(I*m,B-m),className:"yui3-appsview-page-ctrl"+(L<=I?" yui3-appsview-page-disabled":""),text:"\u4e0a\u4e00\u9875"}));for(;G<=E;G++){if((L<=I+2+M&&G<=I+2+M*2)||(L>=E-2-M&&G>=E-2-M*2)||(Math.abs(G-L)<=M)||G==I||G==E){H.push(c.substitute(C,{qs:m*G,className:"yui3-appsview-page-num"+(L==G?" yui3-appsview-page-current":""),text:G+1}))}else{if(G<L){if(!N){H.push(O);N=true}}else{if(!F){H.push(O);F=true}}}}H.push(c.substitute(C,{qs:Math.min(B+m,E*m),className:"yui3-appsview-page-ctrl"+(L>=E?" yui3-appsview-page-disabled":""),text:"\u4e0b\u4e00\u9875"}));H=H.join("")}var D=A(P);D.appendChild(H);j.appendChild(D);g()}function g(){j.one(".yui3-appsview-page").delegate("click",function(C){C.preventDefault();var B=C.currentTarget;if(!B.hasClass("yui3-appsview-page-disabled")&&!B.hasClass("yui3-appsview-page-current")){f=parseInt(B.get("href").split("#")[1]);z()}},"> a")}function z(){if(!j.hasClass("io-sending")){var B=f<0?1:f/m+1;j.addClass("component-loading").empty();c.io(window.configJson.commentUrl,{method:"POST",data:"page="+B,on:{start:function(D,C){j.addClass("io-sending")},success:function(F,E,C){var D=c.JSON.parse(E.responseText);if(D.status==="success"){window.commentData=D.data}e()},failure:function(E,D,C){e()},end:function(D,C){j.removeClass("io-sending")}}})}}function o(){var D=window.commentData.hot.length-a;D=D>10?10:D;if(D>0){var C='<div class="t-r p-v10" id="comments-more-line"><span class="icon-showmore" id="comments-more">\u67e5\u770b\u540e<span id="comments-left">{num}</span>\u6761\u8bc4\u8bba</span></div>',B=A(c.substitute(C,{num:D}));B.one("#comments-more").on("click",function(F){var E=parseInt(F.currentTarget.one("#comments-left").get("text"));t(E)});j.appendChild(B)}}function t(I){var H=window.commentData.hot,B=window.configJson.replyBaseUrl,E="",F,G;for(var D=a,C;D<a+I;++D){H[D].vote=w(H[D].grade);F=H[D].shots;if(F){G='<ul class="shot-list">';for(C=0;C<F.length;++C){F[C].location="hot-"+D+"-"+C;G+=c.substitute(p,F[C])}G+="</ul>"}else{G=""}H[D].imgs=G;H[D].vip=k(H[D]);H[D].replyLink=B+H[D].comId+".html";H[D].info=H[D].info?H[D].info:"";E+=c.substitute(h,H[D])}c.one("#list-comments").appendChild(E);a+=I;l()}function l(){if(a>=45){c.one("#comments-more-line").remove();f=0;n()}else{var B=window.commentData.hot.length-a;B=B>10?10:B;if(B>0){j.one("#comments-left").setContent(B)}else{j.one("#comments-more-line").remove()}}}function i(C){var B=C.currentTarget;if(!B.hasClass("io-sending")){var D=B.getAttribute("commentID");c.io(window.configJson.upBaseUrl,{method:"POST",data:"comId="+D,on:{start:function(F,E){B.addClass("io-sending")},success:function(H,G,E){var F=c.JSON.parse(G.responseText);if(F.state==0){B.setContent("<i>("+F.upNum+")</i>").replaceClass("comment-vote","comment-vote-disabled")}else{B.replaceClass("comment-vote","comment-vote-disabled");alert(F.msg)}},end:function(){B.removeClass("io-sending")}}})}}function r(F){var D,E,B=window.configJson.replyBaseUrl;F.vote=w(F.grade);D=F.shots;if(D){E='<ul class="shot-list">';for(var C=0;C<D.length;++C){D[C].location="mycomment-"+C;E+=c.substitute(p,D[C])}E+="</ul>"}else{E=""}F.imgs=E;F.vip=k(F);F.replyLink=B+F.comId+".html";F.info=F.info?F.info:"";return c.substitute(u,F)}function w(D){if(D){var C=(D/0.05)+"%",B=b[D];return c.substitute(x,{star:C,label:B})}else{return""}}function v(){j.removeClass("component-loading").appendChild(q)}function d(B){if(window.iv){var C,E,D;B=B.split("-");if(B[0]==="mycomment"){E=window.commentData.mycomment.shots;C=B[1]}else{D=B[1];E=(window.commentData.hot)[D].shots;C=B[2]}window.iv.set("shots",E).showImage(C)}}function k(C){var B=C.authV?"v":C.level?C.level:"";return B?'<i class="user-info-40 r2b2 '+B.toLowerCase()+'-40"></i>':""}});
